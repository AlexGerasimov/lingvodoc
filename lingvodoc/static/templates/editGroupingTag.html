<div class="modal-header">
    <h3 class="modal-title">{{ title }}</h3>
</div>

<div class="modal-body">

    <div class="row" style="margin: 30px 0">
        <div class="col-sm-10">
            <wavesurfer id url="" wave-color="#337ab7" progress-color="#23527c" height="128"></wavesurfer>
            <wavesurfer-spectrogram></wavesurfer-spectrogram>
        </div>

        <div class="col-sm-2">
            <button ng-class="{disabled: !isMediaFileAvailable()}" class="btn btn-success btn-block"
                    ng-click="playPause()">
                    <span id="play" ng-show="paused">
                        <i class="glyphicon glyphicon-play"></i>
                        Play
                    </span>

                <span id="pause" ng-show="!paused">
                        <i class="glyphicon glyphicon-pause"></i>
                        Pause
                    </span>
            </button>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12 ">

            <table class="table table-striped table-bordered">
                <thead>
                <tr>
                    <td></td>
                    <td ng-repeat="field in fields" ng-if="field.data_type!='grouping_tag' && !field.isGroup">
                        {{ field.entity_type }}
                    </td>
                </tr>
                </thead>

                <tbody>

                <tr ng-repeat-start="entry in fieldsValues">
                    <td colspan="{{ fields.length }}">
                            <span ng-repeat-start="e in connectedEntries[$index].origin.slice().reverse()">
                                <a ng-attr-href="{{ getPerspectiveLink(e) }}" ng-if="e.type == 'perspective'">{{ e.translation_string }}</a>
                                <span ng-if="e.type != 'perspective'">{{ e.translation_string }}</span>
                            </span>
                        <span ng-repeat-end="" ng-if="$index < (connectedEntries[$parent.$index].origin.length-1)">&gt;&gt;</span>
                    </td>
                </tr>

                <tr ng-repeat-end="">

                    <td>
                        <button type="button" class="btn btn-default" ng-click="unlinkEntry($index)">
                            <span class="glyphicon glyphicon-minus"></span>
                        </button>
                    </td>

                    <td ng-repeat="field in fieldsValues[$index]"
                        ng-if="fieldsIdx[$index].data_type!='grouping_tag' && !fieldsIdx[$index].isGroup">

                        <div ng-if="fieldsIdx[$index].data_type == 'text'">
                            <ul class="entries_list">
                                <li ng-repeat="fieldValue in field">
                                    {{ fieldValue.content }}
                                </li>
                            </ul>

                        </div>


                        <div ng-if="fieldsIdx[$index].data_type == 'image'">
                            <ul class="entries_list">
                                <li ng-repeat="fieldValue in field">
                                    {{ fieldValue.content }}
                                </li>
                            </ul>

                        </div>

                        <div ng-if="fieldsIdx[$index].data_type == 'sound'">

                            <ul class="entries_list">
                                <li ng-repeat="fieldValue in field">
                                    <button type="button" class="btn btn-default btn-sm"
                                            ng-click="play(fieldValue.content)">
                                        <span class="glyphicon glyphicon-play">Play</span>
                                    </button>
                                </li>
                            </ul>

                        </div>

                        <div ng-if="fieldsIdx[$index].isGroup">

                            <button type="button" class="btn btn-default btn-sm"
                                    ng-click="addGroup(entry.client_id, entry.object_id, fieldsIdx[$index])">
                                <span class="glyphicon glyphicon-plus"></span>
                            </button>

                        </div>


                        <div ng-if="fieldsIdx[$index].data_type == 'grouping_tag'">

                            <button type="button" class="btn btn-default btn-sm"
                                    ng-click="addGroup(entry.client_id, entry.object_id, fieldsIdx[$index])">
                                <span class="glyphicon glyphicon-plus"></span>
                            </button>

                        </div>

                    </td>

                </tr>

                </tbody>

            </table>

            <hr>
            <h2>Add connected words</h2>

            <input type="text" class="form-control" ng-model="searchQuery">

            <hr>

            <table class="table table-striped table-bordered">
                <thead>
                <tr>
                    <td></td>
                    <td ng-repeat="field in fields" ng-if="field.data_type!='grouping_tag' && !field.isGroup">{{
                        field.entity_type }}
                    </td>
                </tr>
                </thead>

                <tbody>

                <tr ng-repeat-start="entry in suggestedFieldsValues">
                    <td colspan="{{ fields.length }}">
                            <span ng-repeat-start="e in suggestedEntries[$index].origin.slice().reverse()">
                                <a ng-attr-href="{{ getPerspectiveLink(e) }}" ng-if="e.type == 'perspective'">{{ e.translation_string }}</a>
                                <span ng-if="e.type != 'perspective'">{{ e.translation_string }}</span>
                            </span>
                        <span ng-repeat-end="" ng-if="$index < (suggestedEntries[$parent.$index].origin.length-1)">&gt;&gt;</span>
                    </td>
                </tr>



                <tr ng-repeat-end="">

                    <td>
                        <button type="button" class="btn btn-default" ng-click="linkEntries(suggestedEntries[$index])">
                            <span class="glyphicon glyphicon-plus"></span>
                        </button>
                    </td>

                    <td ng-repeat="field in suggestedFieldsValues[$index]"
                        ng-if="fieldsIdx[$index].data_type!='grouping_tag' && !fieldsIdx[$index].isGroup">

                        <div ng-if="fieldsIdx[$index].data_type == 'text'">
                            <ul class="entries_list">
                                <li ng-repeat="fieldValue in field">
                                    {{ fieldValue.content }}
                                </li>
                            </ul>

                        </div>


                        <div ng-if="fieldsIdx[$index].data_type == 'image'">
                            <ul class="entries_list">
                                <li ng-repeat="fieldValue in field">
                                    {{ fieldValue.content }}
                                </li>
                            </ul>

                        </div>

                        <div ng-if="fieldsIdx[$index].data_type == 'sound'">
                            <ul class="entries_list">
                                <li ng-repeat="fieldValue in field">
                                    <button type="button" class="btn btn-default btn-sm"
                                            ng-click="play(fieldValue.content)">
                                        <span class="glyphicon glyphicon-play">Play</span>
                                    </button>
                                </li>
                            </ul>

                        </div>

                    </td>

                </tr>

                </tbody>

            </table>
        </div>
    </div>
</div>

<div class="modal-footer">
    <button class="btn btn-primary" type="button" ng-click="ok()">OK</button>
</div>