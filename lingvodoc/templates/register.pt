<html>
<head metal:use-macro="load: head.pt">
</head>
<body>
    <div metal:use-macro="load: nav.pt"></div>
<!--    <div class="container"> -->
     <div class="col-lg-6 col-sm-12 col-md-10 col-lg-offset-3 col-md-offset-1">
      <form id="register_form" role="form" action="${request.route_url('register')}" method="post">
        <h2>Зарегистрируйтесь в системе</h2>
        <input id="login" name="login" type="text" class="form-control" placeholder="Выберите логин" required autofocus>
        <input id="password" name="password" type="password" class="form-control" placeholder="Задайте пароль" required>
        <input id="cpassword" name="cpassword" type="password" class="form-control" placeholder="Напишите пароль еще раз, просто на всякий случай" required>
        <input id="name" name="name" type="text" class="form-control" placeholder="Как Вас зовут?" required>
        <input id="email" name="email" type="email" class="form-control" placeholder="Ваш e-mail" required>
        <input class="btn btn-lg btn-primary btn-block" type="submit" value="Зарегистрироваться"></input>
      </form>
     </div>

    <button id="test" class="btn">test</button>
<!--    </div> -->
</body>

<script>
$(document).ready(function () {
    var reg_form = $('#register_form');
    reg_form.validate({
        rules: {
            password: {
                minlength: 5
            },
            cpassword: {
                minlength: 5,
                equalTo: "#password"
            },
            login: {
                remote: {
                    url: "/register/validate/login",
                    type: "post",
                    error: function (jqXHR, textStatus, errorThrown) {
                        noty({text: jqXHR['responseJSON']['error'], timeout: 5000, type: "error"});
                        $("#login").val('');
                        return false;
                    },
                    success: function () {
                        return true;
                    }
                }
            },
            email: {
                remote: {
                    url: "/register/validate/email",
                    type: "post",
                    error: function (jqXHR, textStatus, errorThrown) {
                        alert(jqXHR.status);
                        alert(textStatus);
                        alert(errorThrown);
                    },
                    success: function (data) {
                        return true;
                    }

                }
            }
        },
        submitHandler: function (form) {
            form.submit();
            console.log("in submit handler");
        }
//        submitHandler: function(form) {
//            form.ajaxSubmit();
        //       }

    });

/*)    $('#submit').click(function () {
        console.log(reg_form.valid());
        reg_form.submit();
    }); */
});
</script>
</html>